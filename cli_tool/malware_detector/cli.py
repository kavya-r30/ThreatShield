import argparse
from malware_detector.malware_detector import generate_reports
from malware_detector.ui import main as launch_ui
import webbrowser
import sys

def main():
    parser = argparse.ArgumentParser(description="Malware Detection Tool")
    parser.add_argument("filename", help="Path to the file to analyze", nargs='?')  # Optional filename
    parser.add_argument("--threatshield", action="store_true", help="Open the ThreatShield website")
    args = parser.parse_args()

    if args.threatshield:
        # Open website functionality
        webbrowser.open("https://threatshield-org-admins.vercel.app/")
    elif args.filename:
        # CLI functionality
        try:
            json_output, human_readable = generate_reports(args.filename)
            print("=== JSON Output ===")
            print(json_output)
            print("\n=== Human-Readable Output ===")
            print(human_readable)
        except Exception as e:
            print(f"Error: {str(e)}")
    else:
        # Launch UI
        launch_ui()

if __name__ == "__main__":
    main()